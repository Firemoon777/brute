# brute

For educational purposes only. Use at your own risk.

https://habr.com/ru/companies/selectel/articles/760080/

# Набор инструментов для статьи Et tu, Brute? Что хотят от нас брутфорсеры в 2023?

Только для обучения. Никаких гарантий. Используйте на свой страх и риск. 

## Требования:

- OC Linux, желательно Ubuntu 22.04
- Python 3.10.12
- PostgresSQL 15
- Docker
- Набор данных GeoLite2 в формате CSV (`GeoLite2-ASN` и `GeoLite2-City`)
- Grafana 10.1.1

## Модули

Проект содержит несколько различных компонентов, которые записывают события в свою таблицу в базе данных.

### Пакет brute

Содержит сущности для базы данных, обертку над Docker и SSH-сервер. Может записывать попытки перебирать пароли, а может создавать контейнеры, в которые пропускает всех желающих.

### scan.py

Открывает сырой сокет (raw socket) и считает все пакеты, которые могут быть сканированием портов. Для TCP это SYN-запросы, для UDP -- любой пакет.

### smtp.py

Простейший SMTP-сервер. Бесполезен.

### telnet.py

Простейший telnet-сервер, прикидывающийся login-экраном Ubuntu 22.04. Не считывает пароли.

### web.py

FastAPI-логгер для HTTP/HTTPS. Задуман запускаться через реверс-прокси, например, через nginx.

### geoip.py

Добавляет в таблицу информацию об IP-адресах, которые засветились в одном из компонентов. Выполняется около 20 минут. Лучше всего поместить в cron.
```shell
25 * * * * brute-ip
```

## Подготовка

- Установить БД, записать в переменную окружения URL. Например: `SQLALCHEMY_URL=postgresql://user:pass@127.0.0.1:5432/db`
- Создать каталог `geolite2/` в корне проекта и положить туда csv.
- Сгенерировать хостовый ключ для SSH: `ssh-keygen`. Приватная часть ключа должна иметь имя `key` и находиться в текущем рабочем каталоге.

## Запуск

Примеры запуска можно найти в виде systemd-юнитов.

## Наблюдение

Можно использовать шаблоны Grafana.